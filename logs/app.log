{"time":"2025-05-06T21:00:22.729116477+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":38},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-06T21:00:22.732238421+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":54},"msg":"Database is connected"}
{"time":"2025-05-06T21:00:22.732419565+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-06T21:02:54.418576151+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveTokenHash","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":98},"msg":"can't do query","err":"ERROR: null value in column \"guid\" of relation \"ref_tokens\" violates not-null constraint (SQLSTATE 23502)"}
{"time":"2025-05-06T21:02:54.418607463+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveTokenHash","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":99},"msg":"can't do query","err":"ERROR: null value in column \"guid\" of relation \"ref_tokens\" violates not-null constraint (SQLSTATE 23502)","query":"\n\tINSERT INTO ref_tokens\n\t(token_hash) VALUES ($1) \n\t"}
{"time":"2025-05-06T21:02:54.418721169+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":99},"msg":"failed to save hash refresh token","requestID":"d848ef12-ea12-49a6-a702-fd739ef93473","error":"can't do query:ERROR: null value in column \"guid\" of relation \"ref_tokens\" violates not-null constraint (SQLSTATE 23502)"}
{"time":"2025-05-06T21:02:54.418750649+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":101},"msg":"debug","requestID":"d848ef12-ea12-49a6-a702-fd739ef93473","guid":"a9c2f4c6-212c-4d3d-94df-f8e5855df92f"}
{"time":"2025-05-06T21:03:58.916567443+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-06T21:03:58.916790712+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-06T21:03:58.916811997+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-06T21:11:29.016588107+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":39},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-06T21:11:29.019716437+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":55},"msg":"Database is connected"}
{"time":"2025-05-06T21:11:29.019862839+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-06T21:12:11.245535038+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-06T21:12:11.245760408+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-06T21:12:11.245782053+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-06T21:50:04.139588526+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":39},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-06T21:50:04.14278878+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":55},"msg":"Database is connected"}
{"time":"2025-05-06T21:50:04.14294635+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-06T21:50:51.992705202+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-06T21:50:51.992890839+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-06T21:50:51.992923251+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-06T21:57:21.994940676+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":39},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-06T21:57:21.998216857+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":55},"msg":"Database is connected"}
{"time":"2025-05-06T21:57:21.998430992+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-06T21:58:21.400461492+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-06T21:58:21.400777374+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-06T21:58:21.400805905+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-06T21:58:22.642144593+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":39},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-06T21:58:22.645184755+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":55},"msg":"Database is connected"}
{"time":"2025-05-06T21:58:22.645340249+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-06T21:58:38.119467523+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-06T21:58:38.119643709+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-06T21:58:38.119655019+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-06T21:58:42.396329893+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":39},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-06T21:58:42.3996444+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":55},"msg":"Database is connected"}
{"time":"2025-05-06T21:58:42.399850086+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-06T21:59:30.584784551+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-06T21:59:30.584984944+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-06T21:59:30.585008186+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-06T22:47:34.102787361+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":39},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-06T22:47:34.106056106+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":55},"msg":"Database is connected"}
{"time":"2025-05-06T22:47:34.106307744+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-06T22:47:44.687019199+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-06T22:47:44.687180906+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-06T22:47:44.687196842+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-06T22:49:24.143638323+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":39},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-06T22:49:24.146745179+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":55},"msg":"Database is connected"}
{"time":"2025-05-06T22:49:24.146943132+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-06T22:50:30.345835074+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":31},"msg":"token verification failed","requestID":"aa0ab859-ef1e-45e3-bc06-49643b5031f9","error":"key is of invalid type"}
{"time":"2025-05-06T22:52:13.391780469+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":60},"msg":"invalid request","requestID":"bac93b2d-56c5-439b-99e6-453449367e27","err":"Key: 'Request.GUID' Error:Field validation for 'GUID' failed on the 'uuid' tag"}
{"time":"2025-05-06T22:52:22.01480168+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":60},"msg":"invalid request","requestID":"d68432cb-9519-4805-af4d-3047797adabe","err":"Key: 'Request.GUID' Error:Field validation for 'GUID' failed on the 'uuid' tag"}
{"time":"2025-05-06T22:53:32.732274206+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":31},"msg":"token verification failed","requestID":"d145089a-6ee0-4154-8404-443f939ec2f8","error":"key is of invalid type"}
{"time":"2025-05-06T22:54:16.16719763+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-06T22:54:16.167430197+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-06T22:54:16.167458354+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T11:10:50.154980697+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":39},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T11:10:50.158188945+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":55},"msg":"Database is connected"}
{"time":"2025-05-07T11:10:50.158413663+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T11:11:08.551402989+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":103},"msg":"can't do query","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T11:11:08.551434897+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":104},"msg":"can't do query","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\t"}
{"time":"2025-05-07T11:11:08.55154006+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":125},"msg":"failed to save hash User Info","requestID":"10234368-5bc7-46b7-b593-c2f7e79dafdc","error":"can't do query:ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T11:11:08.551573681+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":127},"msg":"debug","requestID":"10234368-5bc7-46b7-b593-c2f7e79dafdc","guid":"421af6e3-c994-4aeb-99ae-6d750639e5bd"}
{"time":"2025-05-07T11:11:40.390127986+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T11:11:40.390318571+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T11:11:40.390343505+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T11:34:37.198659524+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":41},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T11:34:37.201915252+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":57},"msg":"Database is connected"}
{"time":"2025-05-07T11:34:37.202112583+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T11:34:39.504652222+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":107},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T11:34:39.504688925+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":108},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\t"}
{"time":"2025-05-07T11:34:39.504829411+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":128},"msg":"GUID is already exists","requestID":"d40ae2b8-5400-444f-b3d7-17e1d7004331"}
{"time":"2025-05-07T11:34:39.504858687+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":130},"msg":"debug","requestID":"d40ae2b8-5400-444f-b3d7-17e1d7004331","guid":"421af6e3-c994-4aeb-99ae-6d750639e5bd"}
{"time":"2025-05-07T11:34:39.504892749+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":135},"msg":"failed to save hash User Info","requestID":"d40ae2b8-5400-444f-b3d7-17e1d7004331","error":"GUID is already exists"}
{"time":"2025-05-07T11:34:39.504909758+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":137},"msg":"debug","requestID":"d40ae2b8-5400-444f-b3d7-17e1d7004331","guid":"421af6e3-c994-4aeb-99ae-6d750639e5bd"}
{"time":"2025-05-07T11:34:51.624176136+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T11:34:51.624364687+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T11:34:51.624391265+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T11:34:52.858476648+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":41},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T11:34:52.861515698+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":57},"msg":"Database is connected"}
{"time":"2025-05-07T11:34:52.861701675+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T11:34:54.369266681+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":107},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T11:34:54.369306639+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":108},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\t"}
{"time":"2025-05-07T11:34:54.369384023+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":128},"msg":"GUID is already exists","requestID":"689b9afb-8b62-4d69-a197-2350a00ea85c"}
{"time":"2025-05-07T11:34:54.369406872+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":130},"msg":"debug","requestID":"689b9afb-8b62-4d69-a197-2350a00ea85c","guid":"421af6e3-c994-4aeb-99ae-6d750639e5bd"}
{"time":"2025-05-07T11:36:41.985958528+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":107},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T11:36:41.98599056+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":108},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\t"}
{"time":"2025-05-07T11:36:41.986098513+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":128},"msg":"GUID is already exists","requestID":"eee54b38-532a-4df1-95cb-20e6739dd601"}
{"time":"2025-05-07T11:36:41.986114677+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":130},"msg":"debug","requestID":"eee54b38-532a-4df1-95cb-20e6739dd601","guid":"421af6e3-c994-4aeb-99ae-6d750639e5bd"}
{"time":"2025-05-07T11:41:11.71175678+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":107},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T11:41:11.711798174+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":108},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\t"}
{"time":"2025-05-07T11:41:11.711874939+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":128},"msg":"GUID is already exists","requestID":"562bd43f-dbee-44b9-9566-0ded9e306d58"}
{"time":"2025-05-07T11:41:11.711896727+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":130},"msg":"debug","requestID":"562bd43f-dbee-44b9-9566-0ded9e306d58","guid":"421af6e3-c994-4aeb-99ae-6d750639e5bd"}
{"time":"2025-05-07T11:50:07.794024187+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T11:50:07.794335743+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T11:50:07.794360249+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T11:50:10.89083386+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":41},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T11:50:10.894402051+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":57},"msg":"Database is connected"}
{"time":"2025-05-07T11:50:10.894588732+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T11:50:41.455415195+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T11:50:41.455604887+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T11:50:41.455639784+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T11:51:18.77045466+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":41},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T11:51:18.773463358+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":57},"msg":"Database is connected"}
{"time":"2025-05-07T11:51:18.773644547+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T11:52:37.162597513+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T11:52:37.162813866+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T11:52:37.162834027+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T12:06:24.121060019+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":41},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T12:06:24.124031651+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":57},"msg":"Database is connected"}
{"time":"2025-05-07T12:06:24.124168363+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T12:09:27.754351149+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T12:09:27.754580096+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T12:09:27.75461145+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T12:09:31.985555168+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":41},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T12:09:31.988761757+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":57},"msg":"Database is connected"}
{"time":"2025-05-07T12:09:31.988952974+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T12:10:02.017025968+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T12:10:02.017197295+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T12:10:02.017209879+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T12:12:26.56384162+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":42},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T12:12:26.566845106+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":58},"msg":"Database is connected"}
{"time":"2025-05-07T12:12:26.566962769+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T12:12:38.916812451+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T12:12:38.916988234+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T12:12:38.917024212+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T12:41:54.650984386+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":42},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T12:41:54.654085261+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":58},"msg":"Database is connected"}
{"time":"2025-05-07T12:41:54.654224546+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T12:42:00.202896529+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":108},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T12:42:00.202934929+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":109},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\t"}
{"time":"2025-05-07T12:42:00.203033807+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":133},"msg":"GUID is already exists","requestID":"0a2c0910-0a42-4471-9697-e086cad09a41"}
{"time":"2025-05-07T12:42:00.203057254+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":135},"msg":"debug","requestID":"0a2c0910-0a42-4471-9697-e086cad09a41","guid":"8abb5b49-e4f5-447b-9b25-ecc9f2b492e1"}
{"time":"2025-05-07T12:42:05.42223454+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T12:42:05.422419958+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T12:42:05.42244246+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T13:42:22.107878926+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T13:42:22.111066765+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T13:42:22.111256501+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T13:42:28.270966095+03:00","level":"INFO","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":73},"msg":"Unauthorized","requestID":"27edfd40-25e6-40f1-948b-5b9ac84ed55e"}
{"time":"2025-05-07T13:43:02.149560781+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":114},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T13:43:02.149590198+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":115},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\t"}
{"time":"2025-05-07T13:43:02.149666616+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":133},"msg":"GUID is already exists","requestID":"384ba3be-851e-40dd-9393-9eefd8eedd27"}
{"time":"2025-05-07T13:43:02.149683221+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":135},"msg":"debug","requestID":"384ba3be-851e-40dd-9393-9eefd8eedd27","guid":"8abb5b49-e4f5-447b-9b25-ecc9f2b492e1"}
{"time":"2025-05-07T13:49:08.717560138+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T13:49:08.717772679+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T13:49:08.717808089+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T13:49:09.78556789+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T13:49:09.788975071+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T13:49:09.789119118+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T13:49:15.320502859+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T13:49:15.320731032+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T13:49:15.320755256+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T14:57:29.422714404+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T14:57:29.425781545+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T14:57:29.425924056+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T14:57:32.901624743+03:00","level":"INFO","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":66},"msg":"token is blocked","requestID":"48d063c2-462e-4ebf-bdc6-6f0d3af8a640"}
{"time":"2025-05-07T14:57:39.557542082+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":117},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T14:57:39.557572195+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":118},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\tRETURNING id\n\t"}
{"time":"2025-05-07T14:57:39.557689589+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":132},"msg":"GUID is already exists","requestID":"a76b8dad-3c8b-43e2-a474-d53b615228a6"}
{"time":"2025-05-07T14:57:39.557708785+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":134},"msg":"debug","requestID":"a76b8dad-3c8b-43e2-a474-d53b615228a6","guid":"8abb5b49-e4f5-447b-9b25-ecc9f2b492e1"}
{"time":"2025-05-07T14:57:50.02264868+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":117},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T14:57:50.022683395+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":118},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\tRETURNING id\n\t"}
{"time":"2025-05-07T14:57:50.022772964+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":132},"msg":"GUID is already exists","requestID":"12a3ddbf-377f-46db-b6b2-b768a1a8b6c9"}
{"time":"2025-05-07T14:57:50.022792191+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":134},"msg":"debug","requestID":"12a3ddbf-377f-46db-b6b2-b768a1a8b6c9","guid":"8abb5b49-e4f5-447b-9b25-ecc9f2b492e1"}
{"time":"2025-05-07T14:58:29.932766213+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T14:58:29.933012313+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T14:58:29.93303387+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T14:58:37.097445083+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T14:58:37.100487497+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T14:58:37.100603702+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T14:58:43.239449074+03:00","level":"INFO","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":66},"msg":"token is blocked","requestID":"e7b2b95e-18b4-402a-b1a7-9e522acd5956"}
{"time":"2025-05-07T14:59:04.662537255+03:00","level":"INFO","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":66},"msg":"token is blocked","requestID":"d077710b-a1fe-452f-ab8e-2105c22f1bf1"}
{"time":"2025-05-07T14:59:38.820932218+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T14:59:38.821125206+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T14:59:38.821162366+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T15:11:17.45024791+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T15:11:17.453321992+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T15:11:17.453490399+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T15:11:44.869988065+03:00","level":"INFO","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func3","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":93},"msg":"Unauthorized","requestID":"799a1b9b-992e-440c-8a97-72aad442f5fb"}
{"time":"2025-05-07T15:11:53.60278357+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T15:11:53.602987973+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T15:11:53.603005581+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T15:44:28.348443524+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T15:44:28.351533515+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T15:44:28.351701049+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T15:44:30.851077906+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T15:44:30.851222025+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T15:44:30.851236854+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T15:44:55.211185681+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T15:44:55.214420939+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T15:44:55.21460816+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T15:44:59.432049547+03:00","level":"INFO","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func4","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":93},"msg":"Unauthorized","requestID":"a769b1cc-7d40-4b3a-86f3-b9e085f7b30e"}
{"time":"2025-05-07T15:45:17.174690848+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func4","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":32},"msg":"failed to get token from headers","requestID":"ab511d7f-3dcf-44a7-9fba-e6c1dfc6f5aa"}
{"time":"2025-05-07T15:45:33.324463049+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":117},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T15:45:33.32449734+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":118},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\tRETURNING id\n\t"}
{"time":"2025-05-07T15:45:33.324583737+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":132},"msg":"GUID is already exists","requestID":"86c6d7e0-7288-4bb3-9878-32f975f8ed72"}
{"time":"2025-05-07T15:45:33.324602963+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":134},"msg":"debug","requestID":"86c6d7e0-7288-4bb3-9878-32f975f8ed72","guid":"3b968931-1851-4a49-8264-b0f205d0a3d2"}
{"time":"2025-05-07T15:45:42.686754031+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func4","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":47},"msg":"failed to verify token","requestID":"dba65a14-496c-4f95-a946-36cc8af2affa"}
{"time":"2025-05-07T15:45:53.093957983+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":117},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T15:45:53.094013565+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":118},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\tRETURNING id\n\t"}
{"time":"2025-05-07T15:45:53.094133875+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":132},"msg":"GUID is already exists","requestID":"b1d46329-d8d3-4ad5-8e07-5db80f6efc7e"}
{"time":"2025-05-07T15:45:53.094152588+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":134},"msg":"debug","requestID":"b1d46329-d8d3-4ad5-8e07-5db80f6efc7e","guid":"3b968931-1851-4a49-8264-b0f205d0a3d2"}
{"time":"2025-05-07T15:45:55.671848625+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func4","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":47},"msg":"failed to verify token","requestID":"96e7df87-f6c5-4d7f-9730-4dd210dba9cd"}
{"time":"2025-05-07T15:45:56.704281582+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func4","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":47},"msg":"failed to verify token","requestID":"43ee648c-8aca-4c8a-aa48-35e9986dbe23"}
{"time":"2025-05-07T15:45:57.920938498+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func4","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":47},"msg":"failed to verify token","requestID":"481ab310-158f-4d58-8fb3-2157d01e29b2"}
{"time":"2025-05-07T15:46:15.950598961+03:00","level":"INFO","source":{"function":"medods-test/internal/api.(*API).Endpoints.AuthMiddleware.func4","file":"/home/fzrdub/go/medods-test-task/internal/api/middlewares/auth/auth.go","line":93},"msg":"Unauthorized","requestID":"11849e3f-6ce5-47a9-bf35-233985be29fb"}
{"time":"2025-05-07T15:46:20.239849732+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":117},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T15:46:20.239896943+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":118},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\tRETURNING id\n\t"}
{"time":"2025-05-07T15:46:20.240014221+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":132},"msg":"GUID is already exists","requestID":"a1b9ea25-68ab-40c5-9c18-64d7313bae14"}
{"time":"2025-05-07T15:46:20.240052226+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":134},"msg":"debug","requestID":"a1b9ea25-68ab-40c5-9c18-64d7313bae14","guid":"3b968931-1851-4a49-8264-b0f205d0a3d2"}
{"time":"2025-05-07T15:46:22.828506966+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":117},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T15:46:22.828534724+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":118},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\tRETURNING id\n\t"}
{"time":"2025-05-07T15:46:22.82860927+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":132},"msg":"GUID is already exists","requestID":"1e27b813-39f8-4a4c-8e63-1f57a1b6d8a2"}
{"time":"2025-05-07T15:46:22.828622862+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":134},"msg":"debug","requestID":"1e27b813-39f8-4a4c-8e63-1f57a1b6d8a2","guid":"421af6e3-c994-4aeb-99ae-6d750639e5bd"}
{"time":"2025-05-07T15:46:25.57945486+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":117},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T15:46:25.579480245+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":118},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\tRETURNING id\n\t"}
{"time":"2025-05-07T15:46:25.579565418+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":132},"msg":"GUID is already exists","requestID":"c2112250-b763-4c18-8abd-27c475049927"}
{"time":"2025-05-07T15:46:25.579574878+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":134},"msg":"debug","requestID":"c2112250-b763-4c18-8abd-27c475049927","guid":"421af6e3-c994-4aeb-99ae-6d750639e5bd"}
{"time":"2025-05-07T15:46:34.535218742+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":117},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T15:46:34.535256609+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":118},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\tRETURNING id\n\t"}
{"time":"2025-05-07T15:46:34.535342155+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":132},"msg":"GUID is already exists","requestID":"0e5d98c7-58b4-4641-928c-dde6f0bf0778"}
{"time":"2025-05-07T15:46:34.53536578+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":134},"msg":"debug","requestID":"0e5d98c7-58b4-4641-928c-dde6f0bf0778","guid":"427af6e3-c994-4aeb-99ae-6d750639e6bd"}
{"time":"2025-05-07T15:47:56.594346596+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T15:47:56.594580107+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T15:47:56.594611869+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T15:47:58.534168269+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T15:47:58.537633996+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T15:47:58.53778646+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T15:49:55.279492627+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T15:49:55.279653555+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T15:49:55.279668087+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T15:49:56.47551771+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T15:49:56.478626517+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T15:49:56.478818569+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T15:50:00.448229692+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":99},"msg":"failed to verify token","requestID":"e1b6447b-4844-481f-8b8d-56807c28b58f"}
{"time":"2025-05-07T15:50:46.073368404+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T15:50:46.073548189+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T15:50:46.07356163+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T15:50:47.337750582+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T15:50:47.340859917+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T15:50:47.341062936+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T15:50:48.797025657+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":99},"msg":"failed to verify refresh token","requestID":"bcc6c914-3280-4cdf-88f6-64e63f4496e5"}
{"time":"2025-05-07T15:51:06.320999086+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":99},"msg":"failed to verify refresh token","requestID":"af419ef0-7332-4359-bf30-29ec57b66c5b"}
{"time":"2025-05-07T15:56:40.898986785+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T15:56:40.899185007+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T15:56:40.89919816+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T15:56:42.139537193+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T15:56:42.142660158+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T15:56:42.142853419+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T15:56:47.540913964+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":102},"msg":"failed to verify refresh token","requestID":"c9a4ad9c-9ad5-4c9a-a9df-aa7edfefffe9"}
{"time":"2025-05-07T15:58:57.138713179+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":117},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T15:58:57.138751223+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":118},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\tRETURNING id\n\t"}
{"time":"2025-05-07T15:58:57.138935282+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":132},"msg":"GUID is already exists","requestID":"0439e84d-9e6d-46c8-8a27-739ecb5a2485"}
{"time":"2025-05-07T15:58:57.138956126+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":134},"msg":"debug","requestID":"0439e84d-9e6d-46c8-8a27-739ecb5a2485","guid":"3b968931-1851-4a49-8264-b0f205d0a3d2"}
{"time":"2025-05-07T15:59:05.294824652+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":102},"msg":"failed to verify refresh token","requestID":"830e5c36-e73c-47d3-a7d1-156dcb54a993"}
{"time":"2025-05-07T16:00:41.200119346+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":102},"msg":"failed to verify refresh token","requestID":"dac84f95-6f20-4d84-80fc-b5f21b871edd"}
{"time":"2025-05-07T16:00:59.802995326+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T16:00:59.803228367+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T16:00:59.803245339+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T16:01:00.815313369+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T16:01:00.81838927+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T16:01:00.818547841+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T16:01:02.765925302+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":102},"msg":"failed to verify refresh token","requestID":"9a306320-dcae-4ad3-ba5f-97334a2da3c2","error":"signature is invalid"}
{"time":"2025-05-07T16:01:16.046977679+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T16:01:16.047151871+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T16:01:16.047166604+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T16:33:15.247597865+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T16:33:15.250700588+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T16:33:15.250885144+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T16:33:17.048218251+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":117},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T16:33:17.04824944+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":118},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\tRETURNING id\n\t"}
{"time":"2025-05-07T16:33:17.048332975+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":220},"msg":"GUID is already exists","requestID":"3b6e9134-b27f-4421-9611-b947f1aa2b70"}
{"time":"2025-05-07T16:33:17.048342682+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":222},"msg":"debug","requestID":"3b6e9134-b27f-4421-9611-b947f1aa2b70","guid":"8366b3e3-9934-41e7-b176-0cd21d1eb899"}
{"time":"2025-05-07T16:37:37.805241006+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T16:37:37.80551784+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T16:37:37.805551383+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T16:37:38.781582355+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T16:37:38.784583135+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T16:37:38.784743859+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T16:37:42.062756343+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).UpdateUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":377},"msg":"can't do query","err":"ERROR: syntax error at end of input (SQLSTATE 42601)"}
{"time":"2025-05-07T16:37:42.06279576+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).UpdateUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":378},"msg":"can't do query","err":"ERROR: syntax error at end of input (SQLSTATE 42601)","query":"\n\tUPDATE ref_tokens\n\tSET token_hash = $1, user_agent_hash = $2, ip_hash = $3,\n\t"}
{"time":"2025-05-07T16:37:42.062962991+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":229},"msg":"failed to save hash User Info","requestID":"ebfe4c4e-c76e-4146-a040-c53c40b68a7c","error":"can't do query:ERROR: syntax error at end of input (SQLSTATE 42601)"}
{"time":"2025-05-07T16:37:42.062980781+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":231},"msg":"debug","requestID":"ebfe4c4e-c76e-4146-a040-c53c40b68a7c","guid":"8366b3e3-9934-41e7-b176-0cd21d1eb899"}
{"time":"2025-05-07T16:38:34.500402709+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T16:38:34.500616087+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T16:38:34.500654949+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T16:38:35.511197158+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T16:38:35.514409417+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T16:38:35.514603312+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T16:38:37.6887302+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).UpdateUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":380},"msg":"can't do query","err":"ERROR: syntax error at or near \"WHERE\" (SQLSTATE 42601)"}
{"time":"2025-05-07T16:38:37.688770363+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).UpdateUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":381},"msg":"can't do query","err":"ERROR: syntax error at or near \"WHERE\" (SQLSTATE 42601)","query":"\n\tUPDATE ref_tokens\n\tSET token_hash = $1, user_agent_hash = $2, ip_hash = $3,\n\tWHERE guid = $4\n\t"}
{"time":"2025-05-07T16:38:37.688868104+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":229},"msg":"failed to save hash User Info","requestID":"c46d3221-a2f6-48c9-9af0-e81bad6ab3b8","error":"can't do query:ERROR: syntax error at or near \"WHERE\" (SQLSTATE 42601)"}
{"time":"2025-05-07T16:38:37.688884466+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":231},"msg":"debug","requestID":"c46d3221-a2f6-48c9-9af0-e81bad6ab3b8","guid":"8366b3e3-9934-41e7-b176-0cd21d1eb899"}
{"time":"2025-05-07T16:40:01.020698071+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T16:40:01.020903202+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T16:40:01.020926901+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T16:40:02.928481525+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T16:40:02.931518964+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T16:40:02.931694422+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T16:40:05.213277393+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).UpdateUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":380},"msg":"can't do query","err":"ERROR: syntax error at or near \"WHERE\" (SQLSTATE 42601)"}
{"time":"2025-05-07T16:40:05.213327848+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).UpdateUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":381},"msg":"can't do query","err":"ERROR: syntax error at or near \"WHERE\" (SQLSTATE 42601)","query":"\n\tUPDATE ref_tokens\n\tSET token_hash = $1, user_agent_hash = $2, ip_hash = $3,\n\tWHERE guid = $4\n\t"}
{"time":"2025-05-07T16:40:05.213434682+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":229},"msg":"failed to save hash User Info","requestID":"64d13993-df7c-4b1d-8d3c-175529a1d0b3","error":"can't do query:ERROR: syntax error at or near \"WHERE\" (SQLSTATE 42601)"}
{"time":"2025-05-07T16:40:05.213451544+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":231},"msg":"debug","requestID":"64d13993-df7c-4b1d-8d3c-175529a1d0b3","guid":"8366b3e3-9934-41e7-b176-0cd21d1eb899"}
{"time":"2025-05-07T16:40:18.269730409+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T16:40:18.269922252+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T16:40:18.269935324+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T16:42:46.744539149+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T16:42:46.747803879+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T16:42:46.747977431+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T16:42:48.581307266+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":145},"msg":"Different User Agnet"}
{"time":"2025-05-07T16:42:48.581338032+03:00","level":"INFO","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":147},"msg":"LOGOUTED"}
{"time":"2025-05-07T16:43:13.32901797+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T16:43:13.329213356+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T16:43:13.329238241+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T16:45:52.978483326+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T16:45:52.983167867+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T16:45:52.983422543+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T16:45:58.115398059+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":117},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T16:45:58.115441478+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":118},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\tRETURNING id\n\t"}
{"time":"2025-05-07T16:45:58.115707481+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":132},"msg":"GUID is already exists","requestID":"1ea4ff23-a1ec-45bf-aa81-9ec59869173f"}
{"time":"2025-05-07T16:45:58.115728325+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":134},"msg":"debug","requestID":"1ea4ff23-a1ec-45bf-aa81-9ec59869173f","guid":"8366b3e3-9934-41e7-b176-0cd21d1eb899"}
{"time":"2025-05-07T16:47:02.101614315+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T16:47:02.101854784+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T16:47:02.101881219+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T16:51:29.119066666+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T16:51:29.122089911+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T16:51:29.12222921+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T16:51:40.507157662+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T16:51:40.507358044+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T16:51:40.507397788+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T16:55:10.570718308+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T16:55:10.573973568+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T16:55:10.574165299+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T16:55:20.281845144+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T16:55:20.282039696+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T16:55:20.282075077+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T16:55:57.609708736+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T16:55:57.612797229+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T16:55:57.6129601+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T16:56:37.760558268+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
{"time":"2025-05-07T16:56:37.760752629+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":75},"msg":"Storage is closed. App is shuting down"}
{"time":"2025-05-07T16:56:37.760777494+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":77},"msg":"shutdown completed"}
{"time":"2025-05-07T17:25:43.206955724+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":48},"msg":"Connecting to database","Connect String":"postgresql://postgres:qwerty@localhost:5432/test-task-db?sslmode=disable"}
{"time":"2025-05-07T17:25:43.210032183+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.New","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":64},"msg":"Database is connected"}
{"time":"2025-05-07T17:25:43.210219569+03:00","level":"INFO","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":52},"msg":"Server is started","addres":"localhost:8080"}
{"time":"2025-05-07T17:25:45.175262437+03:00","level":"ERROR","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":117},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)"}
{"time":"2025-05-07T17:25:45.175286729+03:00","level":"DEBUG","source":{"function":"medods-test/internal/storage/postgres.(*PostgreStorage).SaveUserInfo","file":"/home/fzrdub/go/medods-test-task/internal/storage/postgres/postgres.go","line":118},"msg":"GUID is already exists","err":"ERROR: duplicate key value violates unique constraint \"ref_tokens_guid_key\" (SQLSTATE 23505)","query":"\n\tINSERT INTO ref_tokens\n\t(guid, token_hash, user_agent_hash, ip_hash) VALUES ($1, $2, $3, $4) \n\tRETURNING id\n\t"}
{"time":"2025-05-07T17:25:45.175379951+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":132},"msg":"GUID is already exists","requestID":"a6f4f2b2-1db9-4aa8-8de9-aabc60ad86e5"}
{"time":"2025-05-07T17:25:45.175401505+03:00","level":"DEBUG","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func1","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/tokens/token.go","line":134},"msg":"debug","requestID":"a6f4f2b2-1db9-4aa8-8de9-aabc60ad86e5","guid":"8366b3e3-9934-41e7-b176-0cd21d1eb899"}
{"time":"2025-05-07T17:25:48.136366558+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":69},"msg":"failed to check blocked token","requestID":"af489da2-1590-4cb4-b5b7-1074f6edb083","error":"can't do query:number of field descriptions must equal number of destinations, got 0 and 1"}
{"time":"2025-05-07T17:26:54.889724497+03:00","level":"ERROR","source":{"function":"medods-test/internal/api.(*API).Endpoints.New.func2","file":"/home/fzrdub/go/medods-test-task/internal/api/handlers/auth/token/refresh/refresh.go","line":69},"msg":"failed to check blocked token","requestID":"6c850097-9a4c-444d-bd3b-09fc14e5b7e7","error":"can't do query:number of field descriptions must equal number of destinations, got 0 and 1"}
{"time":"2025-05-07T17:27:00.431920311+03:00","level":"ERROR","source":{"function":"main.main","file":"/home/fzrdub/go/medods-test-task/cmd/app/main.go","line":60},"msg":"received signal, starting graceful shutdown","signal":2}
